var json = [{
        id: "0001",
        name: "softwareType"
    },
    {
        id: "00010001",
        name: "Windows",
        value: "Windows",
        memo: "OS_Windows"
    },
    {
        id: "000100010001",
        name: "Windows Server 2008 R2 x64"
    },
    {
        id: "0001000100010001",
        name: "Enterprise"
    },
    {
        id: "00010001000100010001",
        name: "Chinese"
    },
    {
        id: "00010001000100010002",
        name: "English"
    },
    {
        id: "000100010002",
        name: "Windows Server 2008 R2 SP1 x64"
    },
    {
        id: "0001000100020001",
        name: "Enterprise"
    },
    {
        id: "00010001000200010001",
        name: "Chinese"
    },
    {
        id: "00010001000200010002",
        name: "English"
    },
    {
        id: "000100010003",
        name: "Windows Server 2012 x64"
    },
    {
        id: "0001000100030001",
        name: "Standard"
    },
    {
        id: "00010001000300010001",
        name: "Chinese"
    },
    {
        id: "00010001000300010002",
        name: "English"
    },
    {
        id: "0001000100030002",
        name: "DataCenter"
    },
    {
        id: "00010001000300020001",
        name: "Chinese"
    },
    {
        id: "00010001000300020002",
        name: "English"
    },
    {
        id: "000100010004",
        name: "Windows Server 2012 R2 x64"
    },
    {
        id: "0001000100040001",
        name: "Standard"
    },
    {
        id: "00010001000400010001",
        name: "Chinese"
    },
    {
        id: "00010001000400010002",
        name: "English"
    },
    {
        id: "0001000100040002",
        name: "DataCenter"
    },
    {
        id: "00010001000400020001",
        name: "Chinese"
    },
    {
        id: "00010001000400020002",
        name: "English"
    },
    {
        id: "000100010005",
        name: "Windows Server 2016 x64"
    },
    {
        id: "0001000100050001",
        name: "DataCenter"
    },
    {
        id: "00010001000500010001",
        name: "Chinese"
    },
    {
        id: "00010001000500010002",
        name: "English"
    },
    {
        id: "00010002",
        name: "SUSE",
        value: "SUSE",
        memo: "OS_SUSE"
    },
    {
        id: "000100020001",
        name: "SUSE Linux Enterprise 11 SP1 x64"
    },
    {
        id: "000100020002",
        name: "SUSE Linux Enterprise 11 SP2 x64"
    },
    {
        id: "000100020003",
        name: "SUSE Linux Enterprise 11 SP3 x64"
    },
    {
        id: "000100020004",
        name: "SUSE Linux Enterprise 11 SP4 x64"
    },
    {
        id: "000100020005",
        name: "SUSE Linux Enterprise 12 SP1 x64"
    },
    {
        id: "000100020006",
        name: "SUSE Linux Enterprise 12 x64"
    },
    {
        id: "00010003",
        name: "Red Hat",
        value: "Red Hat",
        memo: "OS_Red Hat为什么独缺6.4"
    },
    {
        id: "000100030001",
        name: "Red Hat Linux Enterprise 6.1 x64"
    },
    {
        id: "000100030002",
        name: "Red Hat Linux Enterprise 6.2 x64"
    },
    {
        id: "000100030003",
        name: "Red Hat Linux Enterprise 6.3 x64"
    },
    {
        id: "000100030004",
        name: "Red Hat Linux Enterprise 6.4 x64"
    },
    {
        id: "000100030005",
        name: "Red Hat Linux Enterprise 6.5 x64"
    },
    {
        id: "000100030006",
        name: "Red Hat Linux Enterprise 6.6 x64"
    },
    {
        id: "000100030007",
        name: "Red Hat Linux Enterprise 6.7 x64"
    },
    {
        id: "000100030008",
        name: "Red Hat Linux Enterprise 6.8 x64"
    },
    {
        id: "000100030009",
        name: "Red Hat Linux Enterprise 7.0 x64"
    },
    {
        id: "000100030010",
        name: "Red Hat Linux Enterprise 7.1 x64"
    },
    {
        id: "000100030011",
        name: "Red Hat Linux Enterprise 7.2 x64"
    },
    {
        id: "00010004",
        name: "CentOS",
        value: "CentOS",
        memo: "为什么独缺6.4"
    },
    {
        id: "000100040001",
        name: "CentOS Linux Enterprise 6.2 x64"
    },
    {
        id: "000100040002",
        name: "CentOS Linux Enterprise 6.3 x64"
    },
    {
        id: "000100040003",
        name: "CentOS Linux Enterprise 6.4 x64"
    },
    {
        id: "000100040004",
        name: "CentOS Linux Enterprise 6.5 x64"
    },
    {
        id: "000100040005",
        name: "CentOS Linux Enterprise 6.6 x64"
    },
    {
        id: "000100040006",
        name: "CentOS Linux Enterprise 6.7 x64"
    },
    {
        id: "000100040007",
        name: "CentOS Linux Enterprise 7.0 x64"
    },
    {
        id: "000100040008",
        name: "CentOS Linux Enterprise 7.1 x64"
    },
    {
        id: "000100040009",
        name: "CentOS Linux Enterprise 7.2 x64"
    },
    {
        id: "00010005",
        name: "Ubuntu",
        value: "Ubuntu",
        memo: "OS_Ubuntu"
    },
    {
        id: "000100050001",
        name: "Ubuntu Linux Enterprise 14.04 x64"
    },
    {
        id: "00010006",
        name: "VMWare ESXi",
        value: "VMWare ESXi",
        memo: "OS_VMWare ESXi,为什么独缺6.4"
    },
    {
        id: "000100060001",
        name: "VMWare ESXi 5.0 x64"
    },
    {
        id: "000100060002",
        name: "VMWare ESXi 5.1 x64"
    },
    {
        id: "000100060003",
        name: "VMWare ESXi 5.5 x64"
    },
    {
        id: "000100060004",
        name: "VMWare ESXi 6.0 x64"
    }
]

var softManager = {
    //获取上传中的software列表
    getList: function(param, callback) {
        if (!softManager.checkCefBrowserConnection()) return;

				ExecuteAnynsMethod(param, "getSoftwareSourceTaskList", true, (resultStr) => {
					var result = JSON.parse(resultStr);

					console.log("SoftwareSourceManage getSoftwareSourceTaskList result:");
					console.log(result);

					var ret = { code: result.code, msg: result.description, data: { data: result.data } }
					dealResult(ret, callback);
				});	
    },
    //获取已经上传完成的软件源列表
    getDoneList: function(param, callback) {
        if (!softManager.checkCefBrowserConnection()) return;

				ExecuteAnynsMethod(param, "getSoftwareSourceList", false, (resultStr) => {
					var result = JSON.parse(resultStr);

					console.log("SoftwareSourceManage getSoftwareSourceList result:");
					console.log(result);

					var doneListData = result.data;
					var ret = { code: result.code, msg: result.description, data: doneListData, totalNum: result.totalNum }
					dealResult(ret, callback);
				});	
    },
    //此方法的作用是处理，添加软件源时的，下拉级联联动数据，后台人员暂时不需要修改
    getChildDropList: function(tid) {
        var list = [];
        json.forEach(function(item, index) {
            if (item.id.indexOf(tid) == 0 && item.id.length == tid.length + 4) {
                list.push({
                    value: item.id,
                    label: item.name
                });
            }
        });
        return list;
    },
    //添加software
    add: function(param, callback, failCallback) {
        if (!softManager.checkCefBrowserConnection()) return;

				ExecuteAnynsMethod(param, "save", false, (resultStr) => {
					var result = JSON.parse(resultStr);

					console.log("SoftwareSourceManage save result:");
					console.log(result);

					var ret = { code: result.code, msg: result.description, data: result.data }
					dealResult(ret, callback, failCallback);
				});	
    },
    //删除上传完成的software
    delete: function(param, callback) {
        if (!softManager.checkCefBrowserConnection()) return;

				ExecuteAnynsMethod(param, "delete", false, (resultStr) => {
					var result = JSON.parse(resultStr);

					console.log("SoftwareSourceManage delete result:");
					console.log(result);

					var ret = { code: result.code, msg: result.description }
					dealResult(ret, callback);
				});	
    },
    //清空失败任务的操作
    clear: function(param, callback) {
        if (!softManager.checkCefBrowserConnection()) return;

				ExecuteAnynsMethod(param, "deleteTask", true, (resultStr) => {
					var result = JSON.parse(resultStr);

					console.log("SoftwareSourceManage clear result:");
					console.log(result);

					var ret = { code: result.code, msg: result.description }
					dealResult(ret, callback);
				});	
    },
    //测试是否连接上CefBrowser
    checkCefBrowserConnection: function () {
        if (window.NetBound == undefined || window.NetBound == null || !window.NetBound) {
            //判断cefBrowser是否已注册JsObject
            alert('window.NetBound does not exist.');
            console.log('window.NetBound does not exist.');
            return false;
        }
        return true;
    }
}